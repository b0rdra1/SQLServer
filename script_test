	DECLARE
    @startDate1 DATE = '2023-01-10',
    @endDate1 DATE = '2023-06-15',
    @startDate2 DATE = '2023-05-01',
    @endDate2 DATE = '2023-06-15'

    DECLARE @intersectionStartDate DATE
    DECLARE @intersectionEndDate DATE
    
    SET @intersectionStartDate = CASE WHEN @startDate1 > @startDate2 THEN @startDate1 ELSE @startDate2 END
    SET @intersectionEndDate = CASE WHEN @endDate1 < @endDate2 THEN @endDate1 ELSE @endDate2 END
    
    IF @intersectionStartDate <= @intersectionEndDate
    BEGIN
        SELECT @intersectionStartDate AS IntersectionStartDate, @intersectionEndDate AS IntersectionEndDate
    END
    ELSE
    BEGIN
        SELECT 'No intersection' AS Result
    END

DECLARE @StartDate DATE = '2023-05-20';
DECLARE @EndDate DATE = '2023-10-10';

-- Определяем первый месяц и последний месяц промежутка
DECLARE @FirstMonthStartDate DATE = DATEFROMPARTS(YEAR(@StartDate), MONTH(@StartDate), 1);
DECLARE @LastMonthEndDate DATE = EOMONTH(@EndDate);

-- Создаем временную таблицу для хранения промежутков
CREATE TABLE #Intervals (
    StartDate DATE,
    EndDate DATE
);

-- Вставляем первый промежуток с @StartDate и последним днем месяца, содержащего @StartDate
INSERT INTO #Intervals (StartDate, EndDate)
VALUES (@StartDate, EOMONTH(@StartDate));

-- Генерируем последовательные промежутки для каждого месяца, начиная со следующего месяца, до конца промежутка
DECLARE @NextMonthStartDate DATE = DATEADD(MONTH, 1, @FirstMonthStartDate);
WHILE @NextMonthStartDate <= @LastMonthEndDate
BEGIN
    INSERT INTO #Intervals (StartDate, EndDate)
    VALUES (@NextMonthStartDate, EOMONTH(@NextMonthStartDate));
    
    SET @NextMonthStartDate = DATEADD(MONTH, 1, @NextMonthStartDate);
END

-- Выводим результат
SELECT StartDate, CASE WHEN EndDate > @EndDate THEN @EndDate ELSE EndDate END AS EndDate
FROM #Intervals
WHERE StartDate <= @EndDate;

-- Удаляем временную таблицу
DROP TABLE #Intervals;
